---
title: 数据清洗与SQL语法练习
date: 2025-11-18
tag: 练习
categories: 数据科学
---

# 数据清洗与SQL语法练习

## 初级题目

1. ### 缺失值处理

   - 编写Python脚本，读取包含学生成绩的CSV文件，检测并处理缺失值:
     - 数值型字段用该列均值填充
     - 文本型字段用"未知"填充
     - 输出处理前后的数据统计信息

2. ### 重复数据处理

   - 编写脚本识别并删除完全重复的记录，基于"学号"+"科目"组合删除部分重复记录，保留最新日期的记录

3. ### 数据类型转换

   - 编写脚本将数据中的日期字符串转换为datetime对象，数值字符串转换为float类型，处理转换异常

## 中级题目

1. ### 异常值检测与处理

   - 编写脚本检测学生成绩中的异常值（如<0或>100）,用3σ原则或IQR方法识别异常，分别用删除、截断和均值替换三种方式处理

2. ### 文本数据清洗

   - 编写脚本清洗包含用户评价的数据：
     - 去除HTML标签和特殊字符
     - 统一日期格式（如"2023-01-01"）
     - 标准化手机号格式
     - 提取电子邮件域名

3. ### 数据标准化

   - 编写脚本对数值型数据进行标准化：
     - 最小-最大归一化
     - Z-score标准化
     - 小数定标标准化

## 高级题目

1. ### 多源数据整合

   - 编写脚本整合来自CSV、Excel和JSON三个不同来源的数据：
     - 统一列名和数据类型
     - 处理时间窗口重叠
     - 合并后去重

2. ### 复杂规则清洗

   - 编写脚本实现业务规则验证：
     - 验证身份证号格式和有效性
     - 检查数据逻辑关系（如结束日期>开始日期）
     - 验证数据完整性约束

3. ### 非结构化数据清洗

   - 编写脚本处理半结构化日志数据：
   - 使用正则表达式提取关键信息
   - 解析嵌套JSON结构
   - 处理不完整记录

4. ### 数据质量评估报告

   - 编写脚本生成数据质量评估报告：
     - 计算完整性、准确性、一致性指标
     - 可视化数据分布和异常
     - 输出清洗建议

## 20道SQL语法学习

**基础查询（1-5）**

1. ### 简单查询

   ```sql
   -- 从employees表中选择所有字段，只显示前10条记录
   ```

2. ### 条件查询

   ```sql
   -- 查询工资大于50000的员工姓名和部门
   ```

3. ### 多条件查询

   ```sql
   -- 查询姓名以'张'开头，且包含'伟'字的员工
   ```

4. ### 模糊查询

   ```sql
   -- 查询姓名以'张'开头，且包含'伟'字的员工
   ```

5. ### 范围查询

   ```sql
   -- 查询年龄在25到35岁之间，或者工资在30000到50000之间的员工
   ```

**聚合函数（6-10）**

6. ### 基本聚合

   ```sql
   -- 计算各部门员工数量、平均工资、最高和最低工资
   ```

7. ### 分组统计

   ```sql
   -- 统计每个部门每个职级的员工数量和平均工资
   ```

8. ### 分组过滤

   ```sql
   -- 查询员工数量超过10人的部门及其平均工资
   ```

9. ### 多维度聚合

   ```sql
   -- 按部门和性别统计员工数量，并计算各部门的男女比例
   ```

10. ### 复杂聚合

    ```sql
    -- 计算每个部门的工资差异系数（标准差/平均值）
    ```

**多表连接（11-15）**

11. ### 内连接

    ```sql
    -- 查询员工及其所属部门名称（employees和departments表连接）
    ```

12. ### 左连接

    ```sql
    -- 查询所有员工信息，包括没有分配部门的员工
    ```

13. ### 多表连接

    ```sql
    -- 查询员工姓名、部门名称和项目名称（三个表连接）
    ```

14. ### 自连接

    ```sql
    -- 查询每个员工及其直接上级的姓名
    ```

15. ### 复杂连接

    ```sql
    -- 查询参与了多个项目的员工及其参与的项目数量
    ```

**子查询和高级功能（16-20）**

16. ### 子查询

    ```sql
    -- 查询工资高于本部门平均工资的员工
    ```

17. ### 相关子查询

    ```sql
    -- 查询每个部门工资最高的员工信息
    ```

18. ### 窗口函数

    ```sql
    -- 为每个部门的员工按工资排名，显示排名和工资
    ```

19. ### CASE表达式

    ```sql
    -- 将员工按工资水平分类：高(>80000)、中(40000-80000)、低(<40000)
    ```

20. ### 递归查询

    ```sql
    -- 查询员工的所有下属（包括间接下属）
    ```

### 数据清洗SQL实现

```sql
-- 使用SQL语句清洗数据：
-- 1. 填充缺失的部门信息（用上一有效值填充）
-- 2. 删除重复的员工记录（保留最新记录）
-- 3. 标准化电话号码格式
-- 4. 标记异常工资值（超出3个标准差）
```







